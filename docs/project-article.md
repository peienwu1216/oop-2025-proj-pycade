# Pycade Bomberï¼šç”¨ Python æ‰“é€ æ™ºæ…§ AI èˆ‡ CI/CD é–‹ç™¼æµç¨‹çš„ Pygame å°ˆæ¡ˆ


## 1. å‰è¨€ï¼šä¸åªæ˜¯ä¸€å€‹éŠæˆ²ï¼Œæ›´æ˜¯ä¸€æ¬¡è»Ÿé«”å·¥ç¨‹çš„å¯¦è¸

ç¶“å…¸éŠæˆ²ã€Šç˜‹ç‹‚ç‚¸å½ˆäººã€‹æ‰¿è¼‰äº†è¨±å¤šäººçš„ç«¥å¹´å›æ†¶ï¼Œå…¶ç°¡å–®å»å¯Œæœ‰ç­–ç•¥æ€§çš„ç©æ³•è‡³ä»Šä»è®“äººè‘—è¿·ã€‚å¤šå¹´å‰ï¼Œæˆ‘å€‘åœ˜éšŠæ›¾ä»¥ C++ æ‰“é€ äº†ä¸€å€‹æ–‡å­—ä»‹é¢çš„ç‰ˆæœ¬ï¼Œå¥ å®šäº†å°éŠæˆ²é‚è¼¯èˆ‡ AI è¨­è¨ˆçš„åˆæ­¥ç†è§£ã€‚ç„¶è€Œï¼Œæˆ‘å€‘ä¸¦ä¸æ»¿è¶³æ–¼æ­¤ã€‚

ç‚ºäº†è¿½æ±‚æ›´è±å¯Œçš„è¦–è¦ºé«”é©—ã€æ›´æ™ºæ…§çš„ AI å°æ‰‹ï¼Œä»¥åŠæ›´**è²¼è¿‘æ¥­ç•Œæ¨™æº–çš„é–‹ç™¼æµç¨‹**ï¼Œæˆ‘å€‘æ±ºå®šå•Ÿå‹• **Pycade Bomber** å°ˆæ¡ˆâ€”â€”ä¸€æ¬¡å¾é›¶é–‹å§‹ï¼Œä½¿ç”¨ Python èˆ‡ Pygame çš„ç¾ä»£åŒ–é‡æ§‹ã€‚

é€™ç¯‡æ–‡ç« å°‡ä¸åƒ…åƒ…æ˜¯å±•ç¤ºéŠæˆ²æˆæœï¼Œæ›´æ˜¯ä¸€ä»½è©³ç´°çš„é–‹ç™¼æ—¥èªŒã€‚æˆ‘å€‘å°‡æ·±å…¥æ‹†è§£å°ˆæ¡ˆèƒŒå¾Œçš„ä¸‰å¤§æ ¸å¿ƒï¼š

1.  **ç©©å¥çš„ç‰©ä»¶å°å‘æ¶æ§‹ (OOP)**ï¼šå¦‚ä½•æ‰“é€ ä¸€å€‹æ˜“æ–¼ç¶­è­·èˆ‡æ“´å……çš„éŠæˆ²ä¸–ç•Œã€‚
2.  **å¤šç­–ç•¥çš„æ™ºæ…§ AI (FSM)**ï¼šå¦‚ä½•è¨­è¨ˆå‡ºæ“æœ‰å¤šç¨®ã€Œå€‹æ€§ã€ã€æœƒæ€è€ƒã€æ‡‚æˆ°è¡“çš„ AI å°æ‰‹ã€‚
3.  **æ¥­ç•Œç´šçš„è‡ªå‹•åŒ–æµç¨‹ (CI/CD)**ï¼šå¦‚ä½•é€éè‡ªå‹•åŒ–æ¸¬è©¦èˆ‡éƒ¨ç½²ï¼Œç¢ºä¿ç¨‹å¼ç¢¼å“è³ªä¸¦èƒ½ä¸€éµç™¼ä½ˆã€‚

åœ¨é–‹å§‹ä¹‹å‰ï¼Œä½•ä¸å…ˆè¦ªèº«é«”é©—ä¸€ä¸‹ï¼Ÿ

> **ğŸ‘‰ é¦¬ä¸Šè©¦ç©ï¼š** [Pycade Bomber ç·šä¸ŠéŠæˆ²é€£çµ](https://peienwu1216.github.io/oop-2025-proj-pycade/)
> **ğŸ‘‰ æŸ¥çœ‹åŸå§‹ç¢¼ï¼š** [GitHub å°ˆæ¡ˆé€£çµ](https://github.com/peienwu1216/oop-2025-proj-pycade)

**æŠ€è¡“æ£§ (Tech Stack)**: `Python`, `Pygame`, `Object-Oriented Programming (OOP)`, `Finite State Machine (FSM)`, `A* Search`, `Git`, `GitHub Actions (CI/CD)`, `Pytest`, `flake8`

## 2. å°ˆæ¡ˆçš„è—åœ–ï¼šç©©å¥çš„ç‰©ä»¶å°å‘æ¶æ§‹

ä¸€å€‹å¥½çš„éŠæˆ²ï¼Œåº•å±¤å¿…ç„¶æœ‰ä¸€å€‹ç©©å¥çš„æ¶æ§‹ã€‚éš¨è‘—å°ˆæ¡ˆè¦æ¨¡æ“´å¤§ï¼ˆæˆ‘å€‘çš„å°ˆæ¡ˆè¶…é 5,000 è¡Œç¨‹å¼ç¢¼ï¼‰ï¼Œæ··äº‚çš„çµæ§‹æœƒå°è‡´é–‹ç™¼æ•ˆç‡ä½è½èˆ‡ç„¡ç›¡çš„ bugã€‚ç‚ºæ­¤ï¼Œæˆ‘å€‘åœ¨å°ˆæ¡ˆåˆæœŸå°±å°å…¥äº†ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆ (OOP) çš„æ ¸å¿ƒæ€æƒ³ï¼Œä¸¦é€éä»¥ä¸‹å¹¾å€‹æ–¹é¢ä¾†å¯¦è¸ï¼š

### 2.1 é—œæ³¨é»åˆ†é›¢ (Separation of Concerns)

æˆ‘å€‘å°‡å°ˆæ¡ˆçš„ä¸åŒè·è²¬ï¼ŒåŠƒåˆ†åˆ°ç¨ç«‹çš„æ¨¡çµ„ä¸­ï¼Œè®“æ¯å€‹éƒ¨åˆ†éƒ½å°ˆå¿ƒåšå¥½è‡ªå·±çš„äº‹ã€‚

* `core/`ï¼šè² è²¬éŠæˆ²çš„æ ¸å¿ƒé‹ä½œé‚è¼¯ï¼Œä¾‹å¦‚å ´æ™¯ç®¡ç† (`menu.py`)ã€AI æ§åˆ¶å™¨ (`ai_*.py`)ã€è³‡æºç®¡ç†å™¨ (`audio_manager.py`) ç­‰ã€‚
* `sprites/`ï¼šå®šç¾©æ‰€æœ‰éŠæˆ²ä¸­çœ‹å¾—åˆ°çš„å¯¦é«”ç‰©ä»¶ï¼Œä¾‹å¦‚ç©å®¶ (`player.py`)ã€ç‚¸å½ˆ (`bomb.py`)ã€ç‰†å£ (`wall.py`) ç­‰ã€‚
* `assets/`ï¼šå­˜æ”¾æ‰€æœ‰éœæ…‹è³‡æºï¼ŒåŒ…å«åœ–ç‰‡ã€éŸ³æ•ˆã€å­—é«”å’Œåœ°åœ–è³‡æ–™ã€‚
* `test/`ï¼šå­˜æ”¾æ‰€æœ‰ä½¿ç”¨ Pytest ç·¨å¯«çš„å–®å…ƒæ¸¬è©¦ï¼Œç¢ºä¿æ¯å€‹æ¨¡çµ„çš„æ­£ç¢ºæ€§ã€‚

![ç°¡æ˜“ç‰ˆé¡åˆ¥åœ–](images/class-diagram-overview.png)


é»æ­¤æŸ¥çœ‹æ›´å®Œæ•´è©³ç›¡çš„ [Class Diagram](https://github.com/peienwu1216/oop-2025-proj-pycade/blob/main/ARCHITECTURE.md)

æ­¤å¤–ï¼Œæˆ‘å€‘å°‡æ‰€æœ‰å…¨åŸŸè¨­å®šï¼ˆå¦‚é¡è‰²ã€é€Ÿåº¦ã€è¦–çª—å°ºå¯¸ï¼‰é›†ä¸­åœ¨ `settings.py`ä¸­ç®¡ç†ï¼Œé¿å…äº†ã€é­”æ³•æ•¸å­—ã€(Magic Numbers) çš„å‡ºç¾ï¼Œè®“å°ˆæ¡ˆé…ç½®ä¸€ç›®äº†ç„¶ã€‚

### 2.2 å°è£çš„åŠ›é‡ (Encapsulation)

ã€Œå°è£ã€æ˜¯å°‡è¤‡é›œçš„å…§éƒ¨å¯¦ä½œã€ŒåŒ…è£ã€èµ·ä¾†ï¼Œåªå°å¤–æä¾›ç°¡å–®æ˜“ç”¨çš„æ“ä½œä»‹é¢ã€‚ `AudioManager` æ˜¯é€™å€‹ç†å¿µçš„æœ€ä½³ç¯„ä¾‹ã€‚

ä¸»ç¨‹å¼ (`game.py`) ä¸éœ€è¦çŸ¥é“ `pygame.mixer` å¦‚ä½•åˆå§‹åŒ–ã€å¦‚ä½•è¼‰å…¥éŸ³æ•ˆæª”æ¡ˆã€å¦‚ä½•ç®¡ç†éŸ³è»Œã€‚å®ƒåªéœ€è¦å‘¼å«ä¸€å€‹ç°¡å–®çš„æ–¹æ³•ï¼š

```python
# åœ¨ game.py ä¸­ï¼Œå‘¼å«å°±æ˜¯é€™éº¼ç°¡å–®
self.audio_manager.play_sound('explosion')
```
æ‰€æœ‰è¤‡é›œçš„ç´°ç¯€éƒ½è¢«éš±è—åœ¨ `AudioManager` å…§éƒ¨ã€‚æœªä¾†è‹¥è¦æ›´æ›éŸ³æ•ˆå¼•æ“ï¼Œä¹Ÿåªéœ€è¦ä¿®æ”¹é€™å€‹é¡åˆ¥ï¼Œå®Œå…¨ä¸æœƒå½±éŸ¿åˆ°ä¸»ç¨‹å¼çš„ä»»ä½•ä¸€è¡Œç¨‹å¼ç¢¼ã€‚

```python
# core/audio_manager.py
import pygame

class AudioManager:
    def __init__(self):
        pygame.mixer.init()
        # é å…ˆè¼‰å…¥å°‘é‡ã€å¸¸ç”¨çš„éŸ³æ•ˆ
        self.sounds = {
            'explosion': pygame.mixer.Sound('assets/audio/explosion.wav'),
            'place_bomb': pygame.mixer.Sound('assets/audio/place_bomb.wav')
        }

    def play_sound(self, name):
        if name in self.sounds:
            self.sounds[name].play()
```

### 2.3 ç¹¼æ‰¿èˆ‡ç­–ç•¥æ¨¡å¼ (Inheritance & Strategy Pattern)

æˆ‘å€‘é€éã€Œç¹¼æ‰¿ã€ä¾†å»ºç«‹é€šç”¨çš„ç‰©ä»¶æ¨£æ¿ï¼Œæ¸›å°‘é‡è¤‡çš„ç¨‹å¼ç¢¼ã€‚ä¾‹å¦‚ï¼Œ`Player`ã€`Wall`ã€`Item` ç­‰æ‰€æœ‰éŠæˆ²ç‰©ä»¶éƒ½ç¹¼æ‰¿è‡ªä¸€å€‹é€šç”¨çš„ `GameObject` é¡åˆ¥ï¼Œå…±äº« `image` å’Œ `rect` ç­‰åŸºæœ¬å±¬æ€§ã€‚



ä½†æ›´é€²ä¸€æ­¥ï¼Œæˆ‘å€‘é‹ç”¨äº†ã€Œç­–ç•¥æ¨¡å¼ã€ä¾†è¨­è¨ˆ AI çš„å¤šç¨®ã€Œå€‹æ€§ã€ã€‚

æˆ‘å€‘é¦–å…ˆå®šç¾©äº†ä¸€å€‹ `AIControllerBase` ä½œç‚ºæ‰€æœ‰ AI éƒ½å¿…é ˆéµå®ˆçš„é€šç”¨ä»‹é¢ï¼ˆç­–ç•¥çš„æŠ½è±¡ï¼‰ã€‚æ¥è‘—ï¼Œ`AggressiveAIController`ã€`ConservativeAIController` ç­‰å­é¡åˆ¥å„è‡ªç¹¼æ‰¿æ­¤ä»‹é¢ï¼Œä¸¦ç™¼å±•å‡ºç¨ç‰¹çš„é ‚å±¤ç›®æ¨™ï¼ˆå…·é«”çš„ç­–ç•¥å¯¦ç¾ï¼‰ã€‚

![AI ç­–ç•¥æ¨¡å¼åœ–](images/ai-strategy-pattern.png)

é€™ç¨®è¨­è¨ˆçš„æœ€å¤§å¥½è™•æ˜¯ã€Œé«˜å…§èšã€ä½è€¦åˆã€ã€‚éŠæˆ²ä¸»é«”ä¸éœ€è¦é—œå¿ƒ AI çš„å…§éƒ¨æ±ºç­–é‚è¼¯ï¼Œåªéœ€è¦åœ¨éŠæˆ²é–‹å§‹å‰ï¼Œåƒæ’æ‹”å¡å¸¶ä¸€æ¨£ï¼Œå°‡æŒ‡å®šçš„ AI æ§åˆ¶å™¨ã€Œå®‰è£ã€åˆ°è§’è‰²ä¸Šå³å¯ã€‚é€™ä½¿å¾—æ–°å¢æˆ–ä¿®æ”¹ AI è¡Œç‚ºè®Šå¾—éå¸¸å®¹æ˜“ï¼Œè€Œä¸æœƒå½±éŸ¿åˆ°éŠæˆ²çš„å…¶ä»–éƒ¨åˆ†ã€‚

## 3. AI çš„éˆé­‚ï¼šå¤šç­–ç•¥ FSM æ±ºç­–ç³»çµ±

å¦‚æœèªªç©©å¥çš„æ¶æ§‹æ˜¯å°ˆæ¡ˆçš„éª¨æ¶ï¼Œé‚£éº¼æ™ºæ…§çš„ AI å‰‡æ˜¯å°ˆæ¡ˆçš„éˆé­‚ã€‚æˆ‘å€‘çš„ç›®æ¨™æ˜¯å‰µé€ å‡ºä¸åƒæ©Ÿå™¨äººã€æ‡‚å¾—å¯©æ™‚åº¦å‹¢ã€ç”šè‡³æœƒè¨­ä¸‹é™·é˜±çš„å°æ‰‹ã€‚ç‚ºæ­¤ï¼Œæˆ‘å€‘èåˆäº†å¹¾ç¨®æ ¸å¿ƒæŠ€è¡“ï¼Œæ‰“é€ å‡º AI çš„æ±ºç­–å¤§è…¦ã€‚

### 3.1 æœ‰é™ç‹€æ…‹æ©Ÿ (FSM) - AI çš„æ±ºç­–å¤§è…¦

æˆ‘å€‘ç‚ºæ¯å€‹ AI å°å…¥äº†ã€Œæœ‰é™ç‹€æ…‹æ©Ÿã€(Finite State Machine, FSM)ã€‚é€™ç›¸ç•¶æ–¼ AI çš„æ±ºç­–ä¸­æ¨ï¼Œå®ƒæœƒæ ¹æ“šç•¶å‰çš„æˆ°å ´å±€å‹¢ï¼Œåœ¨ä¸åŒçš„ã€Œç‹€æ…‹ã€ä¹‹é–“é€²è¡Œåˆ‡æ›ï¼Œå¾è€Œåšå‡ºæœ€åˆé©çš„è¡Œç‚ºã€‚

ä¾‹å¦‚ï¼ŒAI çš„æ ¸å¿ƒç‹€æ…‹åŒ…æ‹¬ï¼š
* **`EVADING_DANGER`**ï¼šæœ€é«˜å„ªå…ˆç´šã€‚ç•¶åµæ¸¬åˆ°è‡ªå·±ä½æ–¼ç‚¸å½ˆçš„çˆ†ç‚¸ç¯„åœå…§æ™‚ï¼Œæ‹‹ä¸‹ä¸€åˆ‡ä»»å‹™ï¼Œç«‹åˆ»å°‹æ‰¾å®‰å…¨è·¯å¾‘é€ƒé›¢ã€‚
* **`TACTICAL_RETREAT_AND_WAIT`**ï¼šæ”¾ç½®ç‚¸å½ˆå¾Œï¼Œä¸å‘†åœ¨åŸåœ°ï¼Œè€Œæ˜¯æˆ°è¡“æ€§åœ°æ’¤é€€åˆ°å®‰å…¨ä½ç½®ï¼Œç­‰å¾…çˆ†ç‚¸æˆæœã€‚
* **`PLANNING_ITEM_TARGET`**ï¼šæœå°‹åœ°åœ–ä¸Šçš„é“å…·ï¼Œè¦åŠƒè·¯å¾‘å»æ‹¾å–ä»¥å¢å¼·è‡ªèº«å¯¦åŠ›ã€‚
* **`ENGAGING_PLAYER`**ï¼šä¸»å‹•è¿½æ“Šç©å®¶ï¼Œä¸¦è©¦åœ–åœ¨é©ç•¶çš„ä½ç½®æ”¾ç½®ç‚¸å½ˆé€²è¡Œæ”»æ“Šã€‚
* **`ENDGAME_HUNT`**ï¼šçµ‚å±€æ¨¡å¼ã€‚ç•¶åœ°åœ–ä¸Šçš„éšœç¤™ç‰©è¢«æ¸…ç©ºæ™‚ï¼ŒAI æœƒè®Šå¾—æ¥µå…·æ”»æ“Šæ€§ï¼Œå°ç©å®¶å±•é–‹æœ€çµ‚ç‹©çµï¼ˆé‡å°é“å…·å‹æ¨¡å¼ï¼‰ã€‚


### 3.2 æ™ºæ…§å°‹è·¯æ¼”ç®—æ³• (A* / BFS) - AI çš„è¡Œå‹•æŒ‡å¼•

ç•¶ FSM æ±ºå®šäº†ã€Œç›®æ¨™ã€ï¼ˆè¦å»å“ªè£¡ï¼‰ä¹‹å¾Œï¼ŒAI éœ€è¦ä¸€æ¢è°æ˜çš„è·¯å¾‘ä¾†é”æˆç›®æ¨™ï¼Œè€Œä¸æ˜¯ä¸€é ­æ’ä¸Šç‰†ã€‚ç‚ºæ­¤ï¼Œæˆ‘å€‘åœ¨ AI å…§éƒ¨å¯¦ä½œäº† A\* èˆ‡ BFS å…©ç¨®ç¶“å…¸çš„è·¯å¾‘è¦åŠƒæ¼”ç®—æ³•ã€‚

* **A\* æ¼”ç®—æ³•**ï¼šç”¨æ–¼è¨ˆç®—å‰å¾€é è·é›¢ç›®æ¨™ï¼ˆå¦‚ç©å®¶æˆ–ç‰¹å®šé“å…·ï¼‰çš„æœ€ä½³è·¯å¾‘ï¼Œå®ƒæœƒç¶œåˆè€ƒæ…®å·²èµ°éçš„è·¯å¾‘æˆæœ¬èˆ‡åˆ°çµ‚é»çš„é ä¼°æˆæœ¬ã€‚
* **BFS æ¼”ç®—æ³•**ï¼šç”¨æ–¼å°‹æ‰¾é„°è¿‘æœ€å¿«å¯é”çš„ç›®æ¨™ï¼Œå®ƒä¸è€ƒæ…®æˆæœ¬ï¼Œåªæ±‚ä»¥æœ€å°‘æ­¥æ•¸åˆ°é”ï¼Œéå¸¸é©åˆç”¨æ–¼æˆ°è¡“æ€§çš„å¿«é€Ÿç§»å‹•ï¼Œä¾‹å¦‚é€ƒé›¢å±éšªã€‚

åœ¨æˆ‘å€‘çš„å¯¦ä½œä¸­ï¼Œæˆ‘å€‘é¸æ“‡äº†æœ€ç¶“å…¸ä¸”é«˜æ•ˆçš„æ–¹å¼ä¾†å¯¦ç¾é€™å…©ç¨®æ¼”ç®—æ³•ï¼š

* å°æ–¼ **BFS**ï¼Œæˆ‘å€‘åˆ©ç”¨ Python çš„ `collections.deque` ä½œç‚ºä½‡åˆ— (Queue)ï¼Œå®ƒæä¾›äº†é«˜æ•ˆçš„ append å’Œ popleft æ“ä½œã€‚æˆ‘å€‘é€éä¸€å€‹ `visited` é›†åˆ (Set) ä¾†è¨˜éŒ„å·²è¨ªå•éçš„ç¯€é»ï¼Œä»¥é¿å…åœ¨åœ–ä¸­èµ°å›é ­è·¯æˆ–é™·å…¥ç„¡é™è¿´åœˆã€‚

* å°æ–¼ **A\***ï¼Œå…¶æ ¸å¿ƒåœ¨æ–¼å®ƒçš„è©•ä¼°å‡½æ•¸ $f(n) = g(n) + h(n)$ã€‚æˆ‘å€‘ä½¿ç”¨äº†ä¸€å€‹**å„ªå…ˆä½‡åˆ— (Priority Queue)** ä¾†å­˜æ”¾å¾…æ¢ç´¢çš„ç¯€é»ï¼Œç¢ºä¿æ¯æ¬¡éƒ½èƒ½é¸å‡º $f(n)$ å€¼æœ€å°çš„ç¯€é»é€²è¡Œæ¢ç´¢ã€‚å…¶ä¸­ï¼š
    * $g(n)$ æ˜¯å¾èµ·é»åˆ°ç›®å‰ç¯€é»çš„å¯¦éš›ç§»å‹•æˆæœ¬ï¼ˆæ­¥æ•¸ï¼‰ã€‚
    * $h(n)$ æ˜¯æˆ‘å€‘è¨­è¨ˆçš„**å•Ÿç™¼å‡½æ•¸ (Heuristic Function)**ï¼Œæˆ‘å€‘æ¡ç”¨äº†ã€Œ**æ›¼å“ˆé “è·é›¢ (Manhattan Distance)**ã€ï¼Œå› ç‚ºåœ¨æˆ‘å€‘é€™ç¨®åªèƒ½ä¸Šä¸‹å·¦å³ç§»å‹•çš„ç¶²æ ¼åœ°åœ–ä¸­ï¼Œå®ƒèƒ½éå¸¸å¿«é€Ÿä¸”æº–ç¢ºåœ°ä¼°è¨ˆåˆ°çµ‚é»çš„è·é›¢ã€‚

æˆ‘å€‘æ ¹æ“šä»»å‹™çš„ä¸åŒï¼Œä¾†æ±ºå®šä½¿ç”¨å“ªç¨®æ¼”ç®—æ³•â€”â€”éœ€è¦å¿«é€Ÿæ‰¾åˆ°é„°è¿‘å®‰å…¨é»æ™‚ç”¨ BFSï¼Œéœ€è¦è¦åŠƒé•·é çš„æ”»æ“Šæˆ–å¥ªå¯¶è·¯å¾‘æ™‚ç”¨ A\*ã€‚é€™ç¨®é‡å°æ€§çš„é¸æ“‡ï¼Œæ˜¯æˆ‘å€‘åœ¨å°ˆæ¡ˆä¸­å°æ¼”ç®—æ³•æ•ˆç‡èˆ‡å ´æ™¯æ‡‰ç”¨çš„ **æ¬Šè¡¡ï¼ˆTrade-offï¼‰** èˆ‡å¯¦è¸ã€‚

ç‚ºäº†è®“ç©å®¶èƒ½æ›´ç›´è§€åœ°æ„Ÿå—åˆ° AI çš„ã€Œæ€è€ƒã€ï¼Œæˆ‘å€‘åœ¨éŠæˆ²ç•«é¢çš„å³ä¸‹è§’å³æ™‚é¡¯ç¤ºå‡º AI ç•¶å‰çš„ç‹€æ…‹ã€‚å¦‚åœ–æ‰€ç¤ºï¼Œç•¶ AI ç©å®¶é–å®šå ´ä¸Šçš„é“å…·å¾Œï¼Œæœƒä½¿ç”¨ A* æ¼”ç®—æ³•å°‹æ‰¾ä¸€æ¢æˆæœ¬æœ€ä½çš„è·¯å¾‘ï¼Œä¸¦ä¸”åœ¨æ”¾ç½®ç‚¸å½ˆæ¸…é™¤éšœç¤™ç‰©å¾Œï¼Œä½¿ç”¨ BFS å°‹æ‰¾é„°è¿‘çš„å®‰å…¨æ’¤é€€ä½ç½®ï¼Œä¸¦åˆ‡æ›åˆ°ã€Œ**æˆ°è¡“æ€§æ’¤é€€**ã€ç‹€æ…‹èº²é¿ä¸¦ç­‰å¾…ç‚¸å½ˆçˆ†ç‚¸ã€‚


![AI å°‹è·¯ç¤ºæ„åœ–](images/ai-pathfinding-in-action.jpg)


### 3.3 AI çš„å¤šç¨®ã€Œå€‹æ€§ã€

ç‚ºäº†æå‡éŠæˆ²çš„é‡ç©åƒ¹å€¼èˆ‡æŒ‘æˆ°æ€§ï¼Œæˆ‘å€‘è¨­è¨ˆäº†å¤šç¨®ä¸åŒè¡Œç‚ºæ¨¡å¼çš„ AI å°æ‰‹ï¼Œç©å®¶å¯ä»¥åœ¨ä¸»é¸å–®è‡ªç”±é¸æ“‡ã€‚ 

| AI é¡å‹ | ä¸»è¦è¡Œç‚ºæ¨¡å¼ | ç‰¹é» |
| :--- | :--- | :--- |
| **é“å…·å‹** | å°ˆæ³¨æ–¼ç²å–é“å…·ï¼Œå¼·åŒ–è‡ªèº« | åœ¨éŠæˆ²å‰æœŸæœƒå„ªå…ˆåƒé“å…·ï¼Œç­‰è£å‚™æˆå½¢å¾Œè½‰ç‚ºæ”»æ“Šæ€§ï¼Œæœ€å…·æŒ‘æˆ°æ€§ã€‚ |
| **æ”»æ“Šå‹** | ç©æ¥µè¿½æ“Šå’Œæ”»æ“Šç©å®¶ | ä»¥æ¶ˆæ»…ç©å®¶ç‚ºæœ€ä¸»è¦ç›®æ¨™ï¼Œæœƒæƒ³ç›¡è¾¦æ³•å°‡ç©å®¶é€¼å…¥æ­»è§’ã€‚ |
| **ä¿å®ˆå‹** | è¡Œç‚ºè¬¹æ…ï¼Œå„ªå…ˆè‡ªä¿ | æœƒç›¡é‡é¿é–‹äº¤ç«å€ï¼Œåœ¨å®‰å…¨çš„ç‹€æ³ä¸‹æ‰æ”¾ç½®ç‚¸å½ˆï¼Œè¼ƒå®¹æ˜“å°ä»˜ã€‚ |
| **æ¨™æº–å‹** | åŸºç¤çš„ AI è¡Œç‚ºæ¨¡å¼ | è¡Œç‚ºè¼ƒå‡è¡¡ï¼Œä¹Ÿæ˜¯æˆ‘å€‘æœ€å…ˆé–‹ç™¼çš„æ¨¡å‹ï¼ˆåŸºæœ¬æ¬¾ï¼‰ã€‚æ˜¯ç©å®¶ç†Ÿæ‚‰éŠæˆ²æ©Ÿåˆ¶çš„æœ€ä½³ç·´ç¿’å°è±¡ã€‚ |

## 4. å¯¦è¸æ¥­ç•Œæ¨™æº–çš„é–‹ç™¼èˆ‡å”ä½œæµç¨‹

ä¸€å€‹æˆåŠŸçš„å°ˆæ¡ˆï¼Œä¸åƒ…ä»°è³´å„ªé›…çš„ç¨‹å¼ç¢¼ï¼Œæ›´ä»°è³´ä¸€å¥—æ¸…æ™°ã€é«˜æ•ˆä¸”å¯é çš„é–‹ç™¼èˆ‡å”ä½œæµç¨‹ã€‚æˆ‘å€‘åƒç…§æ¥­ç•Œæ¨™æº–ï¼Œå»ºç«‹äº†çµåˆã€Œäººå·¥æ™ºæ…§ã€èˆ‡ã€Œè‡ªå‹•åŒ–ã€çš„å®Œæ•´ç®¡ç·šï¼Œç¢ºä¿å¾é–‹ç™¼ã€å¯©æŸ¥åˆ°æœ€çµ‚éƒ¨ç½²çš„æ¯ä¸€æ­¥éƒ½åœ¨æŒæ§ä¹‹ä¸­ã€‚é€™è®“æˆ‘å€‘èˆ‡å…¶ä»–èª²ç¨‹å°ˆæ¡ˆæœ€å¤§çš„ä¸åŒä¹‹è™•ã€‚

### 4.1 åˆ†æ”¯ç®¡ç†ç­–ç•¥ (Branching Strategy)

ç‚ºäº†ä¿è­· `main` åˆ†æ”¯ï¼ˆä»£è¡¨äº†éš¨æ™‚å¯ä»¥éƒ¨ç½²çš„ã€Œæ­£å¼ç‰ˆã€ï¼‰çš„çµ•å°ç©©å®šï¼Œæˆ‘å€‘æ¡ç”¨äº†ä»¥ä¸‹ç­–ç•¥ï¼š

* **ç¦æ­¢ç›´æ¥æäº¤ (No Direct Push)**ï¼šå”ä½œè€…ä¸èƒ½ç›´æ¥å°‡ç¨‹å¼ç¢¼æ¨é€åˆ° `main` åˆ†æ”¯ã€‚
* **åŠŸèƒ½åˆ†æ”¯ (Feature Branch)**ï¼šæ¯ç•¶è¦é–‹ç™¼ä¸€å€‹æ–°åŠŸèƒ½ (å¦‚ `feature/new-item`) æˆ–ä¿®å¾©ä¸€å€‹éŒ¯èª¤ (å¦‚ `fix/bomb-bug`)ï¼Œéƒ½å¿…é ˆå¾æœ€æ–°çš„ `main` åˆ†æ”¯å»ºç«‹ä¸€å€‹æ–°çš„ç¨ç«‹åˆ†æ”¯ã€‚æ‰€æœ‰é–‹ç™¼å·¥ä½œéƒ½åœ¨é€™å€‹ç¨ç«‹çš„åˆ†æ”¯ä¸Šé€²è¡Œï¼Œèˆ‡ä¸»ç·šå®Œå…¨éš”é›¢ï¼Œç¢ºä¿ä¸æœƒå½±éŸ¿åˆ°æ­£å¼ç‰ˆçš„ç©©å®šæ€§ã€‚


![Git åˆ†æ”¯ç­–ç•¥åœ–](images/git-branching-strategy.jpg)

### 4.2 åˆä½µè«‹æ±‚èˆ‡ç¨‹å¼ç¢¼å¯©æŸ¥ (Pull Request & Code Review)

ç•¶ä¸€å€‹åŠŸèƒ½åˆ†æ”¯é–‹ç™¼å®Œæˆå¾Œï¼Œé–‹ç™¼è€…æœƒç™¼èµ·ä¸€å€‹ã€Œåˆä½µè«‹æ±‚ã€ (Pull Request, PR)ï¼Œé€™æ˜¯ä¸€å€‹æ­£å¼çš„ã€Œè«‹æ±‚åˆä½µã€çš„ç”³è«‹ï¼Œä¹Ÿæ˜¯æˆ‘å€‘åœ˜éšŠé€²è¡Œé›†é«”æ™ºæ…§å“è³ªæŠŠé—œçš„æ ¸å¿ƒç’°ç¯€ã€‚

* **æ²’æœ‰ç¶“éå¯©æŸ¥çš„ç¨‹å¼ç¢¼ï¼Œå°±æ²’æœ‰è³‡æ ¼è¢«åˆä½µ**ï¼šé€™æ˜¯æˆ‘å€‘çš„æ ¸å¿ƒåŸå‰‡ã€‚PR æœƒé€šçŸ¥åœ˜éšŠçš„å…¶ä»–æˆå“¡é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥ (Code Review)ã€‚
* **å¯©æŸ¥é‡é»**ï¼šå¯©æŸ¥è€…æœƒé—œæ³¨é‚è¼¯æ­£ç¢ºæ€§ã€ç¨‹å¼ç¢¼å“è³ªã€å¯ç¶­è­·æ€§ï¼Œä¸¦æå‡ºä¿®æ”¹å»ºè­°ã€‚
* **å–„ç”¨ AI å·¥å…·**ï¼šæˆ‘å€‘ä¹Ÿå–„ç”¨ AI å·¥å…· (å¦‚ GitHub Copilot) é€²è¡Œåˆæ­¥çš„ Code Reviewï¼Œå®ƒå¯ä»¥å¿«é€Ÿæ‰¾å‡ºä¸€äº›æ½›åœ¨å•é¡Œï¼Œåˆ†æ“”äººé¡å¯©æŸ¥è€…çš„éƒ¨åˆ†å·¥ä½œã€‚

é€éé€™å€‹æµç¨‹ï¼Œæˆ‘å€‘ç¢ºä¿æ¯ä¸€è¡Œåˆä½µé€²ä¸»åˆ†æ”¯çš„ç¨‹å¼ç¢¼ï¼Œéƒ½ç¶“éäº†è‡³å°‘ä¸€ä½ã€Œäººé¡æ™ºæ…§ã€å’Œä¸€ä½ã€Œäººå·¥æ™ºæ…§ã€çš„é›™é‡æª¢é©—ã€‚

![Code Review ç¯„ä¾‹](images/code-review-example.png)

### 4.3 æºé€šèˆ‡ä»»å‹™ç®¡ç†ï¼šäº¤ä»˜å¯è¿½æº¯çš„é–‹ç™¼æ­·ç¨‹
é™¤äº†åˆ¶å®šè¦å‰‡èˆ‡å°å…¥å·¥å…·ï¼Œæˆ‘å€‘ç›¸ä¿¡æ¸…æ™°ã€å¯è¿½æº¯çš„æºé€šæ˜¯å°ˆæ¡ˆæˆåŠŸçš„åŸºçŸ³ã€‚

* **ä»¥ Pull Request ä½œç‚ºè¨è«–çš„è¼‰é«”**ï¼šæˆ‘å€‘ä¸åƒ…åˆ©ç”¨ PR é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥ï¼Œæ›´å°‡å…¶ä½œç‚ºä¸€å€‹å…¬é–‹çš„æŠ€è¡“è¨è«–å€ã€‚æ‰€æœ‰é‡å°ç¨‹å¼ç¢¼çš„å»ºè­°ã€æ¬Šè¡¡èˆ‡æ±ºç­–éç¨‹ï¼Œéƒ½è¢«å®Œæ•´åœ°è¨˜éŒ„ä¸‹ä¾†ï¼Œæˆç‚ºå°ˆæ¡ˆæ­·å²çš„ä¸€éƒ¨åˆ†ã€‚
* **ä»¥ Issues é€²è¡Œç³»çµ±åŒ–ä»»å‹™ç®¡ç†**ï¼šæˆ‘å€‘ä½¿ç”¨ GitHub Issues ä¾†ç®¡ç†å°ˆæ¡ˆçš„å¾…è¾¦äº‹é …ï¼ŒåŒ…æ‹¬åŠŸèƒ½é–‹ç™¼ã€Bug ä¿®å¾©èˆ‡æœªä¾†è¦åŠƒã€‚é€™è®“åœ˜éšŠæˆå“¡å°å°ˆæ¡ˆçš„é€²ç¨‹æœ‰å…±åŒçš„èªçŸ¥ï¼Œä¹Ÿè®“æ•´å€‹é–‹ç™¼æ­·æ„ˆè®Šå¾—é€æ˜ä¸”æœ‰æ¢ç†ã€‚

![GitHub Issues ç®¡ç†åœ–](images/github-issues-management.jpg)



### 4.4 æŒçºŒæ•´åˆ (CI) - è‡ªå‹•åŒ–çš„å“è³ªå®ˆé–€å“¡

åœ¨äººå·¥å¯©æŸ¥çš„åŸºç¤ä¸Šï¼Œæˆ‘å€‘é‚„æœ‰ä¸€ä½ä¸çŸ¥ç–²å€¦çš„ã€Œè‡ªå‹•åŒ–å®ˆé–€å“¡ã€ã€‚ç•¶ PR è¢«ç™¼èµ·æ™‚ï¼ŒGitHub Actions æœƒè‡ªå‹•åŸ·è¡Œå…©é“ä¸»è¦çš„å“è³ªæª¢æ¸¬ï¼š

1.  **ç¨‹å¼ç¢¼æª¢æŸ¥ (flake8)**ï¼š`Python`é¢¨æ ¼èˆ‡å“è³ªæª¢æŸ¥ï¼Œæ•æ‰æ½›åœ¨èªæ³•å•é¡Œã€‚
2.  **å–®å…ƒåŠŸèƒ½æ¸¬è©¦ (Pytest)**ï¼šåŸ·è¡Œæ‰€æœ‰å–®å…ƒæ¸¬è©¦ï¼Œç¢ºä¿æ–°åŠŸèƒ½æ²’æœ‰ç ´å£èˆŠåŠŸèƒ½ã€‚

åªæœ‰ç•¶äººå·¥å¯©æŸ¥å’Œè‡ªå‹•åŒ–æ¸¬è©¦éƒ½é€šéå¾Œï¼Œç¨‹å¼ç¢¼æ‰è¢«å…è¨±åˆä½µã€‚

![CI æª¢æŸ¥é€šéåœ–](images/ci-checks-passed.png)

æˆ‘å€‘ç‚ºå°ˆæ¡ˆçš„é—œéµæ ¸å¿ƒé‚è¼¯ç·¨å¯«äº†å–®å…ƒæ¸¬è©¦ï¼Œä¸»è¦æ¶µè“‹ï¼š

* **é—œéµæ¥­å‹™é‚è¼¯ (Business Logic)**ï¼šé©—è­‰ Player å—å‰µå¾Œçš„ç”Ÿå‘½é€±æœŸã€Bomb çš„ç‹€æ…‹è½‰æ›ã€Item çš„æ•ˆæœæ‡‰ç”¨ç­‰æ ¸å¿ƒéŠæˆ²è¦å‰‡ã€‚
* **è³‡æ–™æŒä¹…åŒ– (Data Persistence)**ï¼šç¢ºä¿ LeaderboardManager å°æ–¼åˆ†æ•¸çš„è®€å¯«èˆ‡æ’åºé‚è¼¯æº–ç¢ºç„¡èª¤ã€‚
* **é‚Šç•Œæ¢ä»¶ (Edge Cases)**ï¼šæ¸¬è©¦è«¸å¦‚ç”Ÿå‘½å€¼ç‚ºé›¶ã€ç‚¸å½ˆæ•¸é‡é”åˆ°ä¸Šé™ç­‰æ¥µç«¯æƒ…æ³ä¸‹çš„ç³»çµ±è¡Œç‚ºã€‚

é€™äº›æ¸¬è©¦å¦‚åŒæˆ‘å€‘çš„ã€Œ**å®‰å…¨ç¶²**ã€ã€‚åœ¨æˆ‘å€‘ä¸æ–·æ–°å¢åŠŸèƒ½æˆ–é‡æ§‹ç¨‹å¼ç¢¼æ™‚ï¼Œå®ƒèƒ½ç«‹åˆ»æ•æ‰åˆ°å› ä¿®æ”¹è€Œç”¢ç”Ÿçš„æ„å¤–éŒ¯èª¤ (Regression)ï¼Œè®“æˆ‘å€‘å¯ä»¥æ›´æœ‰ä¿¡å¿ƒåœ°é€²è¡Œé–‹ç™¼è¿­ä»£ï¼Œç¢ºä¿äº†å°ˆæ¡ˆçš„é•·æœŸç©©å®šæ€§ã€‚

![CI Flow](images/ci-workflow-diagram.png)

### 4.5 æŒçºŒéƒ¨ç½² (CD) - ä¸€éµç™¼ä½ˆåˆ°å…¨ä¸–ç•Œ

ç•¶ç¨‹å¼ç¢¼æˆåŠŸåˆä½µåˆ° `main` åˆ†æ”¯å¾Œï¼ŒæŒçºŒéƒ¨ç½²æµç¨‹æœƒè‡ªå‹•è§¸ç™¼ã€‚GitHub Actions æœƒè‡ªå‹•å°‡å°ˆæ¡ˆæ‰“åŒ…æˆç¶²é ç‰ˆæœ¬ï¼Œä¸¦ç™¼ä½ˆåˆ° GitHub Pagesã€‚é€™æ„å‘³è‘—æ¯ä¸€æ¬¡æˆåŠŸçš„åˆä½µï¼Œç©å®¶å°±èƒ½åœ¨å¹¾åˆ†é˜å…§ç©åˆ°æœ€æ–°çš„éŠæˆ²ç‰ˆæœ¬ï¼Œè€Œæˆ‘å€‘å®Œå…¨ä¸éœ€è¦æ‰‹å‹•ä»‹å…¥ã€‚


ç•¶ç¨‹å¼ç¢¼æˆåŠŸåˆä½µåˆ° `main` åˆ†æ”¯å¾Œï¼Œéƒ¨ç½²æµç¨‹æœƒè‡ªå‹•è§¸ç™¼ã€‚å…¶æµç¨‹å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š

![CD Flow](images/cd-deployment-diagram.png)

GitHub Actions æœƒè‡ªå‹•å°‡å°ˆæ¡ˆæ‰“åŒ…æˆç¶²é ç‰ˆæœ¬ï¼Œä¸¦å°‡éŠæˆ²ç™¼ä½ˆåˆ°ç¶²é ã€‚

## 5. æŠ€è¡“æŒ‘æˆ°èˆ‡è§£æ±ºæ–¹æ¡ˆ

æ‰€æœ‰æˆåŠŸçš„å°ˆæ¡ˆéƒ½ä¸æ˜¯ä¸€å¸†é¢¨é †çš„ï¼ŒçœŸæ­£çš„å­¸ç¿’å¾€å¾€ç™¼ç”Ÿåœ¨å…‹æœå›°é›£çš„éç¨‹ä¸­ã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘æƒ³åˆ†äº«å¹¾å€‹åœ¨é–‹ç™¼ Pycade Bomber æ™‚é‡åˆ°çš„å…·é«”æŒ‘æˆ°ï¼Œä»¥åŠæˆ‘å€‘æ˜¯å¦‚ä½•è§£æ±ºå®ƒå€‘çš„ã€‚

### 5.1 AI éœ‡ç›ªä¹‹è¬ï¼šç‹€æ…‹åˆ‡æ›èˆ‡éºå¤±çš„è·¯å¾‘

åœ¨é–‹ç™¼åˆæœŸï¼Œæˆ‘å€‘é‡åˆ°äº†AI è¨­è¨ˆä¸­ä¸€å€‹éå¸¸ç¶“å…¸çš„å•é¡Œï¼šè¡Œç‚ºéœ‡ç›ª (Oscillation)ã€‚

* **é‡åˆ°çš„å•é¡Œ**ï¼šAI ç©å®¶åœ¨æŸäº›æƒ…æ³ä¸‹æœƒã€Œå¡ä½ã€ï¼Œåœ¨åŸåœ°å¾®å¾®é¡«æŠ–ï¼Œä¼¼ä¹åœ¨å…©å€‹ç›®æ¨™æˆ–å…©å€‹ç‹€æ…‹ä¹‹é–“çŒ¶è±«ä¸æ±ºï¼Œç„¡æ³•åŸ·è¡Œä»»ä½•æœ‰æ•ˆçš„ç§»å‹•ã€‚
* **é™¤éŒ¯éç¨‹**ï¼šç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å€‘ç‚º AI è¨­è¨ˆäº†ä¸€å¥—è©³ç´°çš„æ—¥èªŒç³»çµ± (`ai_log`)ï¼Œç”¨ä¾†è¿½è¹¤æ¯ä¸€å¹€ (frame) AI çš„ç‹€æ…‹è®ŠåŒ–ã€æ±ºç­–éç¨‹ä»¥åŠè·¯å¾‘è¦åŠƒçš„çµæœã€‚é€éåˆ†æå¤§é‡çš„æ—¥èªŒï¼Œæˆ‘å€‘ç™¼ç¾äº†ä¸€å€‹å¥‡æ€ªçš„æ¨¡å¼ï¼šAI çš„è·¯å¾‘è¦åŠƒå‡½å¼ç¢ºå¯¦æˆåŠŸè¨ˆç®—ä¸¦è¨­å®šäº†ä¸€æ¢æœ‰æ•ˆçš„ç§»å‹•è·¯å¾‘ï¼Œä½†å¹¾ä¹åœ¨åŒä¸€æ™‚é–“ï¼Œç•¶ AI æº–å‚™åŸ·è¡Œç§»å‹•æ™‚ï¼Œé‚£æ¢è·¯å¾‘å»åˆç¥ç§˜åœ°è®Šæˆäº†ç©ºçš„ã€‚
* **æ ¹æœ¬åŸå› **ï¼šåœ¨è¿½è¹¤ç¨‹å¼ç¢¼å¾Œï¼Œæˆ‘å€‘çµ‚æ–¼æ‰¾åˆ°äº†ã€Œå…‡æ‰‹ã€â€”â€”å•é¡Œå‡ºåœ¨ `AIControllerBase` é¡åˆ¥çš„ `change_state` å‡½å¼ä¸­ã€‚æˆ‘å€‘æœ€åˆçš„è¨­è¨ˆæ˜¯ï¼Œç‚ºäº†ç¢ºä¿ç‹€æ…‹åˆ‡æ›çš„ç´”ç²¹æ€§ï¼Œæ¯ä¸€æ¬¡å‘¼å« `change_state` æ™‚ï¼Œéƒ½æœƒç„¡æ¢ä»¶åœ°å°‡ AI çš„ç•¶å‰ç§»å‹•è·¯å¾‘ (`self.current_movement_sub_path`) æ¸…ç©ºã€‚é€™å°è‡´äº†è‡´å‘½çš„é€£é–åæ‡‰ï¼šä¸€å€‹ã€Œè¦åŠƒã€ç‹€æ…‹ï¼ˆå¦‚ `PLANNING_ITEM_TARGET`ï¼‰è¾›è¾›è‹¦è‹¦è¨ˆç®—å‡ºçš„è·¯å¾‘ï¼Œåœ¨å®ƒå‘¼å« `change_state` åˆ‡æ›åˆ°ã€ŒåŸ·è¡Œã€ç‹€æ…‹ï¼ˆå¦‚ `MOVING_TO_COLLECT_ITEM`ï¼‰çš„ç¬é–“ï¼Œå°±è¢« `change_state` å‡½å¼æœ¬èº«çµ¦æ¸…ç©ºäº†ã€‚AI é€²å…¥ç§»å‹•ç‹€æ…‹å¾Œï¼Œç™¼ç¾ç„¡è·¯å¯èµ°ï¼Œåªå¥½å†æ¬¡é‡æ–°è¦åŠƒï¼Œé™·å…¥äº†ã€Œè¦åŠƒ->æ¸…ç©º->è¦åŠƒã€çš„æ­»å¾ªç’°ã€‚

ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å€‘é‡æ§‹äº† `change_state` å‡½å¼ã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹å‰å¾Œçš„ç¨‹å¼ç¢¼å°æ¯”ï¼š

**ä¿®æ”¹å‰ (æœ‰å•é¡Œçš„ç‰ˆæœ¬)**
```python
# ai_controller_base.py
# åœ¨ change_state å‡½å¼ä¸­ï¼Œç„¡æ¢ä»¶æ¸…ç©ºè·¯å¾‘
def change_state(self, new_state):
    if self.current_state != new_state:
        # ... (æ›´æ–°ç‹€æ…‹èˆ‡æ™‚é–“)
        self.current_state = new_state
        self.state_start_time = pygame.time.get_ticks()

        # å•é¡Œé»ï¼šä¸è«–æ–°ç‹€æ…‹æ˜¯ä»€éº¼ï¼Œéƒ½ç›´æ¥æ¸…ç©ºè·¯å¾‘ï¼
        self.current_movement_sub_path = [] 
        self.current_movement_sub_path_index = 0
        # ...
```
**ä¿®æ”¹å¾Œ (è§£æ±ºæ–¹æ¡ˆ)**
```python
# ai_controller_base.py
# ä¿®æ”¹å¾Œçš„ change_state å‡½å¼
def change_state(self, new_state):
    if self.current_state != new_state:
        # ... (æ›´æ–°ç‹€æ…‹èˆ‡æ™‚é–“)
        self.current_state = new_state
        self.state_start_time = pygame.time.get_ticks()

        # --- è§£æ±ºæ–¹æ¡ˆ ---
        # åªæœ‰åœ¨é€²å…¥éœ€è¦ã€Œé‡æ–°è¦åŠƒã€çš„ç‰¹å®šç‹€æ…‹æ™‚ï¼Œæ‰æ¸…ç©ºè·¯å¾‘ã€‚
        # é€™èƒ½é¿å…å‰›è¨­å®šå¥½çš„è·¯å¾‘ï¼Œåœ¨åˆ‡æ›åˆ°ã€ŒåŸ·è¡Œã€ç‹€æ…‹æ™‚è¢«æ„å¤–æ¸…é™¤ã€‚
        if new_state.startswith("PLANNING_") or new_state in ["IDLE", "DEAD"]:
            self.current_movement_sub_path = []
            self.current_movement_sub_path_index = 0
        
        # ... (å…¶ä»–ç‹€æ…‹æ¸…ç†é‚è¼¯) ...
```

é€™å€‹é™¤éŒ¯éç¨‹è®“æˆ‘å€‘æ·±åˆ»é«”æœƒåˆ°ï¼Œåœ¨è¤‡é›œçš„ç‹€æ…‹æ©Ÿè¨­è¨ˆä¸­ï¼Œç‹€æ…‹è½‰æ›æ™‚çš„ã€Œå‰¯ä½œç”¨ç®¡ç†ã€æ˜¯å¤šéº¼é‡è¦ã€‚ä¸€å€‹çœ‹ä¼¼ç„¡å®³çš„æ¸…ç†å‹•ä½œï¼Œå¦‚æœæ²’æœ‰è€ƒæ…®åˆ°ä¸Šä¸‹æ–‡ï¼Œå°±å¯èƒ½å°è‡´é›£ä»¥è¿½æŸ¥çš„é‚è¼¯éŒ¯èª¤ã€‚

### 5.2 ç€è¦½å™¨éŸ³è¨Šçš„é™·é˜±ï¼šè§£æ±º Web ç’°å¢ƒçš„è‡ªå‹•æ’­æ”¾é™åˆ¶

å°‡ Pygame å°ˆæ¡ˆé€é `pygbag` éƒ¨ç½²åˆ°ç¶²é ä¸Šï¼Œé›–ç„¶èƒ½è®“ç©å®¶æ–¹ä¾¿åœ°é«”é©—ï¼Œä½†ä¹Ÿå¸¶ä¾†äº†è¨±å¤š Web ç’°å¢ƒç¨æœ‰çš„æŒ‘æˆ°ï¼Œå…¶ä¸­æœ€å…¸å‹çš„å°±æ˜¯éŸ³è¨Šæ’­æ”¾å•é¡Œã€‚

* **é‡åˆ°çš„å•é¡Œ**ï¼šæˆ‘å€‘çš„éŠæˆ²åœ¨æ¡Œé¢ç‰ˆä¸ŠéŸ³æ•ˆä¸€åˆ‡æ­£å¸¸ï¼Œä½†éƒ¨ç½²åˆ° Web ä¹‹å¾Œï¼Œä¸€æ‰“é–‹éŠæˆ²é é¢ï¼Œå°±æœƒçœ‹åˆ°ä¸€å€‹ `MEDIA USER ACTION REQUIRED` çš„éŒ¯èª¤è¨Šæ¯ï¼Œå°è‡´éŠæˆ²å®Œå…¨æ²’æœ‰è²éŸ³ï¼Œå°¤å…¶åœ¨æ‰‹æ©Ÿç€è¦½å™¨ä¸Šé€™å€‹å•é¡Œå¹¾ä¹å¿…ç„¶ç™¼ç”Ÿã€‚

* **åŸå› æ¢ç©¶**ï¼šç¶“éç ”ç©¶æˆ‘å€‘äº†è§£åˆ°ï¼Œé€™æ˜¯ç¾ä»£ç€è¦½å™¨ç‚ºäº†æå‡ä½¿ç”¨è€…é«”é©—è€Œè¨­ä¸‹çš„ã€Œ**è‡ªå‹•æ’­æ”¾æ”¿ç­– (Autoplay Policy)**ã€ã€‚ç‚ºäº†é˜²æ­¢æƒ¡æ„ç¶²ç«™ä¸€æ‰“é–‹å°±è‡ªå‹•æ’­æ”¾æƒ±äººçš„å»£å‘Šæˆ–éŸ³æ¨‚ï¼Œç€è¦½å™¨è¦å®šï¼Œä»»ä½•éŸ³è¨Šçš„æ’­æ”¾ï¼ˆç”šè‡³åŒ…æ‹¬éŸ³è¨Šç³»çµ±çš„åˆå§‹åŒ– `pygame.mixer.init()`)ï¼Œéƒ½å¿…é ˆåœ¨ä½¿ç”¨è€…å°é é¢é€²è¡Œäº†**é¦–æ¬¡ã€Œäº’å‹•ã€ï¼ˆä¾‹å¦‚é»æ“Šã€è§¸æ§ï¼‰ä¹‹å¾Œ**æ‰èƒ½åŸ·è¡Œã€‚æˆ‘å€‘åŸæœ¬çš„ç¨‹å¼åœ¨éŠæˆ²ä¸€è¼‰å…¥æ™‚å°±åˆå§‹åŒ–äº†éŸ³è¨Šç³»çµ±ï¼Œå› æ­¤ç›´æ¥è§¸ç™¼äº†é€™å€‹é™åˆ¶ã€‚

* **è§£æ±ºæ–¹æ¡ˆ**ï¼šæˆ‘å€‘çš„ç­–ç•¥æ˜¯ã€Œ**å»¶é²åˆå§‹åŒ–**ã€ã€‚æˆ‘å€‘ä¸å†æ–¼éŠæˆ²å•Ÿå‹•æ™‚ç«‹åˆ»è¼‰å…¥ä¸»éŠæˆ²å ´æ™¯ï¼Œè€Œæ˜¯è¨­è¨ˆäº†ä¸€å€‹å…¨æ–°çš„ `StartScene` (é–‹å§‹ç•«é¢) ä½œç‚ºéŠæˆ²çš„å…¥å£ï¼Œä¸¦åœ¨ `main.py` ä¸­å¯¦ä½œäº†ä¸€å€‹ç°¡å–®çš„å ´æ™¯ç®¡ç†è¿´åœˆã€‚

    1.  **å»ºç«‹å…¥å£å ´æ™¯**ï¼šéŠæˆ²å¾ `StartScene` é–‹å§‹ï¼Œå®ƒçš„å”¯ä¸€ä»»å‹™ï¼Œå°±æ˜¯é¡¯ç¤ºä¸€å€‹ç°¡å–®çš„ã€Œé»æ“Šç•«é¢ä»¥é–‹å§‹éŠæˆ²ã€çš„æç¤ºã€‚
    2.  **ç­‰å¾…ä½¿ç”¨è€…äº’å‹•**ï¼šç¨‹å¼æœƒåœåœ¨é€™å€‹ç•«é¢ï¼Œç›´åˆ°åµæ¸¬åˆ°ä½¿ç”¨è€…çš„ç¬¬ä¸€æ¬¡æ»‘é¼ é»æ“Šæˆ–è¢å¹•è§¸æ§ã€‚
    3.  **äº’å‹•å¾Œæ‰åˆå§‹åŒ–**ï¼šåœ¨æ¥æ”¶åˆ°ä½¿ç”¨è€…çš„äº’å‹•äº‹ä»¶å¾Œï¼Œ`StartScene` æœƒçµæŸï¼Œä¸¦å›å‚³ä¸‹ä¸€å€‹å ´æ™¯ï¼ˆ`Menu`ï¼‰çš„å¯¦ä¾‹ã€‚åœ¨æ­¤ä¹‹å¾Œï¼Œæ ¸å¿ƒçš„ `AudioManager` æ‰èƒ½è¢«å®‰å…¨åœ°ä½¿ç”¨ã€‚

ä»¥ä¸‹æ˜¯ `main.py` ä¸­ä¸»éŠæˆ²è¿´åœˆçš„ç°¡åŒ–ç‰ˆï¼Œæ¸…æ™°åœ°å±•ç¤ºäº†é€™å€‹æµç¨‹ï¼š

```python
# main.py

async def main():
	# ... (çœç•¥äº† pygame åˆå§‹åŒ–èˆ‡è¢å¹•è¨­å®š) ...

	# å»ºç«‹å”¯ä¸€çš„ AudioManager å¯¦ä¾‹
	audio_manager = AudioManager()

	# éŠæˆ²å¾ StartScene é–‹å§‹ï¼Œæ­¤æ™‚å°šæœªæ’­æ”¾éŸ³è¨Š
	current_scene = StartScene(screen, audio_manager, clock)

	running_main_loop = True
	while running_main_loop:
		events = pygame.event.get()
		# ... (è™•ç† QUIT äº‹ä»¶) ...

		# current_scene.update() æœƒè™•ç†è©²å ´æ™¯çš„é‚è¼¯ï¼Œ
		# ä¸¦åœ¨éœ€è¦åˆ‡æ›æ™‚ï¼Œå›å‚³ä¸‹ä¸€å€‹å ´æ™¯çš„å¯¦ä¾‹
		next_scene_candidate = current_scene.update(events, dt)

		# å¦‚æœå›å‚³çš„ä¸æ˜¯ç•¶å‰å ´æ™¯ï¼Œå°±é€²è¡Œåˆ‡æ›
		if next_scene_candidate is not current_scene:
			current_scene = next_scene_candidate

		# ... (è™•ç†ç¹ªåœ–èˆ‡è¿´åœˆçµæŸé‚è¼¯) ...

	pygame.quit()

if __name__ == '__main__':
	asyncio.run(main())
```

é€™å€‹ã€Œå…ˆäº’å‹•ï¼Œå¾Œè¼‰å…¥ã€çš„æµç¨‹ï¼Œå®Œç¾åœ°ç¹éäº†ç€è¦½å™¨çš„è‡ªå‹•æ’­æ”¾é™åˆ¶ï¼Œç¢ºä¿äº†éŸ³è¨Šç³»çµ±èƒ½è¢«åˆæ³•å•Ÿå‹•ã€‚é€™å€‹ç¶“é©—è®“æˆ‘å€‘å­¸åˆ°ï¼Œå°‡æ‡‰ç”¨ç¨‹å¼å¾ä¸€å€‹å¹³å°ç§»æ¤åˆ°å¦ä¸€å€‹å¹³å°æ™‚ï¼Œå¿…é ˆå……åˆ†è€ƒæ…®ç›®æ¨™å¹³å°çš„ç¨ç‰¹è¦ç¯„èˆ‡é™åˆ¶ï¼Œè€Œä¸åƒ…åƒ…æ˜¯ç¨‹å¼ç¢¼æœ¬èº«çš„é‚è¼¯ã€‚é€™æ˜¯ä¸€å€‹å…¸å‹çš„ã€Œåœ¨æˆ‘çš„é›»è…¦ä¸Šå¯ä»¥è·‘ã€(It works on my machine) å•é¡Œçš„ Web ç‰ˆæœ¬ï¼Œè€Œè§£æ±ºå®ƒçš„éç¨‹è®“æˆ‘å€‘ç²ç›Šè‰¯å¤šã€‚

## 6. ç¸½çµèˆ‡æœªä¾†å±•æœ›

å¾ä¸€å€‹ C++ çš„æ–‡å­—éŠæˆ²ï¼Œåˆ°ä¸€å€‹åŠŸèƒ½å®Œæ•´ã€éƒ¨ç½²åœ¨ç¶²é ä¸Šçš„ Pycade Bomberï¼Œé€™è¶Ÿé‡æ§‹ä¹‹æ—…è®“æˆ‘å€‘æ”¶ç©«é —è±ã€‚é€™ä¸åƒ…åƒ…æ˜¯ä¸€æ¬¡æŠ€è¡“çš„å‡ç´šï¼Œæ›´æ˜¯ä¸€æ¬¡é–‹ç™¼æ€ç¶­çš„å…¨é¢é€²åŒ–ã€‚

æˆ‘å€‘æˆåŠŸåœ°ï¼š
* **æ‰“é€ äº†ç©©å¥çš„è»Ÿé«”æ¶æ§‹**ï¼šé€éç‰©ä»¶å°å‘èˆ‡è¨­è¨ˆæ¨¡å¼ï¼Œè®“å°ˆæ¡ˆçš„æ“´å……èˆ‡ç¶­è­·è®Šå¾—è¼•é¬†ã€‚
* **å¯¦ç¾äº†å¤šç­–ç•¥çš„æ™ºæ…§ AI**ï¼šçµåˆ FSM èˆ‡è·¯å¾‘è¦åŠƒï¼Œå‰µé€ å‡ºæ‡‚å¾—æ€è€ƒã€è¡Œç‚ºå¤šæ¨£çš„éŠæˆ²å°æ‰‹ã€‚
* **å»ºç«‹äº†å°ˆæ¥­çš„é–‹ç™¼æµç¨‹**ï¼šå°å…¥ CI/CD è‡ªå‹•åŒ–ç®¡ç·šï¼Œå¾æ­¤å‘Šåˆ¥æ‰‹å‹•æ¸¬è©¦èˆ‡éƒ¨ç½²çš„ç¹ç‘£ï¼Œå‘æ¥­ç•Œæ¨™æº–çœ‹é½Šã€‚

é€™å€‹å°ˆæ¡ˆæœ€çµ‚ä¸åƒ…åƒ…æ˜¯ä¸€å€‹å¯ä»¥ç©çš„éŠæˆ²ï¼Œæ›´æ˜¯æˆ‘å€‘åœ˜éšŠåœ¨è»Ÿé«”å·¥ç¨‹é ˜åŸŸä¸Šï¼Œå¾è¨­è¨ˆã€é–‹ç™¼ã€æ¸¬è©¦åˆ°äº¤ä»˜çš„å®Œæ•´å¯¦è¸ã€‚

### æœªä¾†å±•æœ› (Future Work)

Pycade Bomber çš„ä¸–ç•Œé‚„æœ‰å»£é—Šçš„æ¢ç´¢ç©ºé–“ï¼Œæˆ‘å€‘è¦åŠƒäº†å¹¾å€‹ä»¤äººèˆˆå¥®çš„æœªä¾†æ–¹å‘ï¼š

* **åœ¨ã€éŠæˆ²æ€§ã€‘æ–¹é¢** ï¼š
    * **ç¶²è·¯é€£ç·šå°æˆ°**ï¼šå¯¦ç¾çœŸæ­£çš„å¤šäººç·šä¸Šå°æˆ°ï¼Œé€™æ˜¯ Bomberman é¡å‹éŠæˆ²çš„éˆé­‚ï¼ 
    * **æ›´å¤šå…ƒçš„éŠæˆ²å…§å®¹**ï¼šè¨­è¨ˆæ›´å¤šæ¨£åŒ–çš„åœ°åœ–ã€ç‰¹è‰²é“å…·èˆ‡é™·é˜±ï¼Œç”šè‡³åŠ å…¥å¼·å¤§çš„ Boss é—œå¡ã€‚ 
    * **é—œå¡ç·¨è¼¯å™¨**ï¼šè®“ç©å®¶å¯ä»¥è‡ªè¡Œè¨­è¨ˆåœ°åœ–ï¼Œä¸Šå‚³ä¸¦åˆ†äº«ï¼Œå¯¦ç¾ä½¿ç”¨è€…ç”Ÿæˆå…§å®¹ (UGC)ã€‚ 

* **åœ¨ã€æŠ€è¡“æ·±åº¦ã€‘æ–¹é¢** ï¼š
    * **å¼·åŒ–å­¸ç¿’ (Reinforcement Learning)**ï¼šåœ¨ç¾æœ‰çš„ AI åŸºç¤ä¸Šï¼Œå¼•å…¥å¼·åŒ–å­¸ç¿’æ¨¡å‹é€²è¡Œè¨“ç·´ï¼Œè®“ AI èƒ½è‡ªä¸»å­¸ç¿’å‡ºæ›´é ‚å°–çš„éŠæˆ²ç­–ç•¥ã€‚ 
    * **æ•ˆèƒ½èˆ‡è¦–è¦ºå„ªåŒ–**ï¼šå„ªåŒ–æ¸²æŸ“æ•ˆèƒ½ï¼Œä¸¦åŠ å…¥æ›´ç²¾ç¾çš„ç²’å­ç‰¹æ•ˆèˆ‡è§’è‰²å‹•ç•«ï¼Œæå‡æ•´é«”çš„è¦–è¦ºé«”é©—ã€‚ 
    * **è·¨å¹³å°æ”¯æ´**ï¼šå°‡éŠæˆ²æ‰“åŒ…æˆæ¡Œé¢æ‡‰ç”¨ç¨‹å¼ (Windows/macOS)ï¼Œè€Œä¸åƒ…é™æ–¼ç¶²é ã€‚

### æ­¡è¿æ‚¨çš„è²¢ç»ï¼(We Welcome Contributions!)

Pycade Bomber æ˜¯ä¸€å€‹å……æ»¿ç†±æƒ…çš„å°ˆæ¡ˆï¼Œæˆ‘å€‘ä¹Ÿéå¸¸æ­¡è¿æœ‰åŒæ¨£ç†±æƒ…çš„æ‚¨åŠ å…¥ç¤¾ç¾¤ï¼Œä¸€åŒè®“å®ƒè®Šå¾—æ›´å¥½ï¼

* å¦‚æœæ‚¨ç™¼ç¾äº†ä»»ä½• Bug æˆ–æœ‰æ–°çš„åŠŸèƒ½æƒ³æ³•ï¼Œæ­¡è¿åˆ°æˆ‘å€‘çš„ [**GitHub Issues**](https://github.com/peienwu1216/oop-2025-proj-pycade/issues) é é¢æå‡ºã€‚
* å¦‚æœæ‚¨å¸Œæœ›ç›´æ¥è²¢ç»ç¨‹å¼ç¢¼ï¼Œè«‹å…ˆé–±è®€æˆ‘å€‘çš„[**è²¢ç»æŒ‡å— (CONTRIBUTING.md)**](https://github.com/peienwu1216/oop-2025-proj-pycade/blob/main/CONTRIBUTING.md)ï¼Œä¸¦éš¨æ™‚ç™¼èµ· Pull Requestã€‚
* æˆ‘å€‘ä¹Ÿæ¨™ç¤ºäº†ä¸€äº›é©åˆæ–°æ‰‹å…¥é–€çš„ [**Good First Issues**](https://github.com/peienwu1216/oop-2025-proj-pycade/labels/good%20first%20issue)ï¼Œå¦‚æœæ‚¨æƒ³å°è©¦èº«æ‰‹ï¼Œå¾é€™è£¡é–‹å§‹æ˜¯å€‹ä¸éŒ¯çš„é¸æ“‡ï¼

æ„Ÿè¬æ‚¨çš„é–±è®€ï¼å¸Œæœ›é€™ç¯‡æ–‡ç« èƒ½ç‚ºæ­£åœ¨å­¸ç¿’ Python éŠæˆ²é–‹ç™¼æˆ–å°è»Ÿé«”å·¥ç¨‹å¯¦è¸æ„Ÿèˆˆè¶£çš„æ‚¨å¸¶ä¾†ä¸€äº›å•Ÿç™¼ã€‚

å¦‚æœæ‚¨é‚„æ²’ç©éï¼Œä¸å¦¨é»æ“Šä¸‹æ–¹é€£çµï¼ŒæŒ‘æˆ°ä¸€ä¸‹æˆ‘å€‘ç²¾å¿ƒè¨­è¨ˆçš„ AI å§ï¼

> **ğŸ‘‰ é¦¬ä¸Šè©¦ç©ï¼š** [Pycade Bomber ç·šä¸ŠéŠæˆ²é€£çµ](https://peienwu1216.github.io/oop-2025-proj-pycade/)
> **ğŸ‘‰ æŸ¥çœ‹åŸå§‹ç¢¼ï¼š** [GitHub å°ˆæ¡ˆé€£çµ](https://github.com/peienwu1216/oop-2025-proj-pycade)
